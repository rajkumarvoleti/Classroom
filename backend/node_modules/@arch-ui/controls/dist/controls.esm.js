import _extends from '@babel/runtime/helpers/esm/extends';
import React, { useMemo, memo, createElement } from 'react';
import { Checkbox as Checkbox$1, CheckboxGroup as CheckboxGroup$1, Radio as Radio$1, RadioGroup as RadioGroup$1 } from 'react-radios';
import _objectSpread from '@babel/runtime/helpers/esm/objectSpread2';
import _objectWithoutProperties from '@babel/runtime/helpers/esm/objectWithoutProperties';
import { PseudoState } from 'react-pseudo-state';
import styled from '@emotion/styled';
import { colors } from '@arch-ui/theme';
import { HiddenInput } from '@arch-ui/input';

const Wrapper = styled.div({
  display: 'flex',
  alignItems: 'center'
});
const Label = styled.label({
  alignItems: 'center',
  display: 'flex',
  lineHeight: 1
});
const Text = 'span';
const Icon = styled.div(({
  checked,
  isDisabled,
  isFocus,
  isActive,
  isHover
}) => {
  // background
  let bg = colors.N10;

  if (isDisabled && checked) {
    bg = colors.N30;
  } else if (isActive) {
    bg = checked ? colors.B.D10 : colors.N20;
  } else if ((isFocus || isHover) && !checked) {
    bg = colors.N15;
  } else if (checked) {
    bg = colors.B.base;
  } // fill


  let fill = 'white';

  if (isDisabled && checked) {
    fill = colors.N70;
  } else if (!checked) {
    fill = 'transparent';
  } // stroke


  let innerStroke = isFocus ? colors.B.L20 : bg;
  let innerStrokeWidth = 1;

  if (checked && !isDisabled) {
    innerStroke = isActive ? colors.B.D20 : colors.B.base;
  }

  let outerStroke = 'transparent';
  let outerStrokeWidth = 1;

  if (isFocus && !isActive) {
    outerStroke = colors.B.A20;
    outerStrokeWidth = 5;
  }

  return {
    color: bg,
    fill,
    lineHeight: 0,
    cursor: isDisabled ? 'not-allowed' : null,
    // awkwardly apply the focus ring
    '& .outer-stroke': {
      transition: 'stroke 0.2s ease-in-out',
      stroke: outerStroke,
      strokeWidth: outerStrokeWidth
    },
    '& .inner-stroke': {
      stroke: innerStroke,
      strokeWidth: innerStrokeWidth
    }
  };
});
const defaultComponents = {
  Wrapper,
  Label,
  Text
};
const Control = (_ref) => {
  let {
    checked = false,
    children,
    components: propComponents = {},
    isDisabled = false,
    isRequired,
    name,
    onChange,
    icon: IconContent,
    tabIndex,
    type,
    value,
    id
  } = _ref,
      wrapperProps = _objectWithoutProperties(_ref, ["checked", "children", "components", "isDisabled", "isRequired", "name", "onChange", "icon", "tabIndex", "type", "value", "id"]);

  const components = useMemo(() => _objectSpread(_objectSpread({}, defaultComponents), propComponents), [propComponents]);
  return /*#__PURE__*/React.createElement(components.Wrapper, wrapperProps, /*#__PURE__*/React.createElement(PseudoState, null, ({
    onBlur,
    onFocus,
    onKeyDown,
    onKeyUp,
    onMouseDown,
    onMouseEnter,
    onMouseLeave,
    onMouseUp,
    onTouchEnd,
    onTouchStart
  }, snapshot) => {
    const labelHandlers = {
      onMouseDown,
      onMouseUp,
      onMouseEnter,
      onMouseLeave,
      onTouchEnd,
      onTouchStart
    };
    const inputHandlers = {
      onBlur,
      onChange,
      onFocus,
      onKeyDown,
      onKeyUp
    };

    const iconProps = _objectSpread(_objectSpread({}, snapshot), {}, {
      checked,
      isDisabled
    });

    return /*#__PURE__*/React.createElement(components.Label, _extends({
      isChecked: checked,
      isDisabled: isDisabled
    }, labelHandlers), /*#__PURE__*/React.createElement(HiddenInput, _extends({}, inputHandlers, {
      checked: checked,
      disabled: isDisabled,
      name: name,
      required: isRequired,
      tabIndex: tabIndex,
      type: type,
      value: value,
      id: id
    })), /*#__PURE__*/React.createElement(Icon, iconProps, /*#__PURE__*/React.createElement(IconContent, null)), children ? /*#__PURE__*/React.createElement(components.Text, null, children) : null);
  }));
};

const CheckboxIcon = /*#__PURE__*/memo(props => /*#__PURE__*/createElement("svg", _extends({
  focusable: "false",
  height: "24",
  role: "presentation",
  viewBox: "0 0 24 24",
  width: "24"
}, props), /*#__PURE__*/createElement("g", {
  fillRule: "evenodd"
}, /*#__PURE__*/createElement("rect", {
  className: "outer-stroke",
  fill: "transparent",
  x: "6",
  y: "6",
  width: "12",
  height: "12",
  rx: "2"
}), /*#__PURE__*/createElement("rect", {
  className: "inner-stroke",
  fill: "currentColor",
  x: "6",
  y: "6",
  width: "12",
  height: "12",
  rx: "2"
}), /*#__PURE__*/createElement("path", {
  d: "M9.707 11.293a1 1 0 1 0-1.414 1.414l2 2a1 1 0 0 0 1.414 0l4-4a1 1 0 1 0-1.414-1.414L11 12.586l-1.293-1.293z",
  fill: "inherit"
}))));
const RadioIcon = /*#__PURE__*/memo(props => /*#__PURE__*/createElement("svg", _extends({
  focusable: "false",
  height: "24",
  role: "presentation",
  viewBox: "0 0 24 24",
  width: "24"
}, props), /*#__PURE__*/createElement("g", {
  fillRule: "evenodd"
}, /*#__PURE__*/createElement("circle", {
  className: "outer-stroke",
  fill: "transparent",
  cx: "12",
  cy: "12",
  r: "7"
}), /*#__PURE__*/createElement("circle", {
  className: "inner-stroke",
  fill: "currentColor",
  cx: "12",
  cy: "12",
  r: "7"
}), /*#__PURE__*/createElement("circle", {
  fill: "inherit",
  cx: "12",
  cy: "12",
  r: "2"
}))));
const CheckboxPrimitive = props => /*#__PURE__*/createElement(Control, _extends({
  icon: CheckboxIcon,
  type: "checkbox"
}, props));
const RadioPrimitive = props => /*#__PURE__*/createElement(Control, _extends({
  icon: RadioIcon,
  type: "radio"
}, props));

const Checkbox = props => /*#__PURE__*/React.createElement(Checkbox$1, _extends({
  component: CheckboxPrimitive
}, props));
const CheckboxGroup = props => /*#__PURE__*/React.createElement(CheckboxGroup$1, props);
const Radio = props => /*#__PURE__*/React.createElement(Radio$1, _extends({
  component: RadioPrimitive
}, props));
const RadioGroup = props => /*#__PURE__*/React.createElement(RadioGroup$1, props);

export { Checkbox, CheckboxGroup, CheckboxPrimitive, Radio, RadioGroup, RadioPrimitive };
